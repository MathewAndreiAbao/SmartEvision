import{d as $e,b as Ce,a as u,f,s as g}from"../chunks/zt7kUNSb.js";import{p as Oe,o as Ve,h as Ie,a as He,e as Re,s,c as e,b as v,d as y,g as r,$ as Ee,n as S,r as t,i as ee,t as k}from"../chunks/D02y27Ec.js";import{i as _}from"../chunks/CyaklKEO.js";import{h as Fe,s as Ne}from"../chunks/DG2cR9Zm.js";import{a as Ae,s as Le}from"../chunks/HxVFllSf.js";import{p as Te}from"../chunks/DcK2uUSv.js";import{g as Be}from"../chunks/Gotkd5Cc.js";import{S as Me}from"../chunks/BlBMRgHN.js";import{Q as Qe}from"../chunks/DY8Zasrq.js";import{lookupOfflineDoc as Pe,cacheVerifiedDoc as We}from"../chunks/fWpnswL0.js";import{S as qe,W as Ke}from"../chunks/NMw9WXxT.js";import{C as Ue}from"../chunks/D95vVFjk.js";import{C as Ge,a as Je}from"../chunks/DbfI9puR.js";import{S as Xe}from"../chunks/CBsLl3Jd.js";import{F as Ye}from"../chunks/ChsElkNZ.js";import{C as Ze}from"../chunks/DB24PY1k.js";var et=f('<div class="glass-card-static p-12 text-center" role="status" aria-label="Loading verification"><div class="w-12 h-12 border-4 border-gov-blue/20 border-t-gov-blue rounded-full animate-spin mx-auto mb-4"></div> <p class="text-text-muted font-bold uppercase tracking-widest text-xs">Authenticating Hash...</p></div>'),tt=f(`<div class="glass-card-static p-10 text-center border-l-4 border-gov-red animate-shake" role="alert"><!> <h2 class="text-xl font-black text-gov-red mb-2 uppercase tracking-tight">Invalid Document</h2> <p class="text-sm text-text-secondary mb-6 font-medium">The scanned hash does not match any official record in our
                    secure registry.</p> <div class="p-3 bg-gov-red/5 rounded-lg border border-gov-red/10"><code class="text-[10px] text-gov-red font-mono break-all"> </code></div></div>`),at=f('<div class="inline-flex items-center gap-1.5 px-3 py-1 bg-gov-gold/10 text-gov-gold rounded-full text-[10px] font-black uppercase tracking-widest mt-4 border border-gov-gold/20"><!> Offline Mode Verification</div>'),rt=f('<div class="flex justify-between items-center text-sm"><span class="text-text-muted font-bold uppercase tracking-widest text-[10px]">Submitted By</span> <span class="text-text-primary font-black"> </span></div>'),st=f('<div class="flex justify-between items-center text-sm"><span class="text-text-muted font-bold uppercase tracking-widest text-[10px]">Origination</span> <span class="text-text-primary font-black"> </span></div>'),it=f('<div class="flex justify-between items-center text-sm"><span class="text-text-muted font-bold uppercase tracking-widest text-[10px]">Category</span> <span class="text-gov-blue font-black uppercase text-[10px] px-2 py-0.5 bg-gov-blue/5 rounded"> </span></div>'),ot=f('<div class="glass-card-static overflow-hidden border-t-4 border-gov-green shadow-elevated" role="region" aria-label="Verification result"><div class="bg-gov-green/5 p-8 text-center border-b border-gray-100"><div class="w-16 h-16 bg-gov-green rounded-full flex items-center justify-center text-white shadow-lg mx-auto mb-4 animate-bounce-subtle"><!></div> <h2 class="text-2xl font-black text-gov-green tracking-tight uppercase">Verified</h2> <div class="flex items-center justify-center gap-2 mt-2"><!> <p class="text-xs text-text-muted font-bold uppercase tracking-widest">Official Smart E-VISION Record</p></div> <!></div> <div class="p-8 space-y-6"><div class="grid grid-cols-1 gap-5"><div class="flex items-start gap-4"><div class="p-2.5 rounded-xl bg-gray-50 text-text-muted"><!></div> <div class="flex-1 min-w-0"><p class="text-[10px] text-text-muted font-black uppercase tracking-widest mb-1">Document Name</p> <p class="text-sm font-bold text-text-primary truncate"> </p></div></div> <div class="grid grid-cols-2 gap-4"><div class="flex items-start gap-4"><div class="p-2.5 rounded-xl bg-gray-50 text-text-muted"><!></div> <div><p class="text-[10px] text-text-muted font-black uppercase tracking-widest mb-1">Status</p> <!></div></div> <div class="flex items-start gap-4"><div class="p-2.5 rounded-xl bg-gray-50 text-text-muted"><!></div> <div><p class="text-[10px] text-text-muted font-black uppercase tracking-widest mb-1">Upload Time</p> <p class="text-xs font-bold text-text-primary"> </p></div></div></div> <div class="border-t border-gray-50 pt-5 space-y-4"><!> <!> <!></div> <div class="p-4 bg-surface-muted/50 rounded-2xl border border-gray-100"><p class="text-[10px] text-text-muted font-black uppercase tracking-widest mb-2">Registry Hash (SHA-256)</p> <code class="text-[11px] font-mono text-gov-blue break-all leading-relaxed block"> </code></div></div></div></div>'),dt=f('<!> <div class="min-h-screen gradient-mesh flex items-center justify-center p-6"><div class="w-full max-w-lg animate-slide-up"><div class="text-center mb-8"><div class="w-14 h-14 mx-auto rounded-2xl bg-gradient-to-br from-gov-blue to-gov-blue-dark flex items-center justify-center text-white text-2xl font-bold shadow-elevated mb-3">E</div> <h1 class="text-xl font-bold text-text-primary">Smart E-VISION</h1> <p class="text-sm text-text-muted">Document Verification</p></div> <!> <div class="flex flex-col gap-3 mt-6"><button class="w-full flex items-center justify-center gap-2 py-3.5 px-6 bg-gradient-to-r from-gov-blue to-gov-blue-dark text-white font-bold text-sm uppercase tracking-widest rounded-2xl shadow-lg hover:shadow-xl active:scale-[0.98] transition-all min-h-[48px]" aria-label="Scan another QR code to verify a different document"><!> Scan Another Document</button> <a href="/dashboard" class="block text-center text-sm text-text-muted hover:text-gov-blue transition-colors py-2">BACK TO Smart E-VISION</a></div></div></div>',1);function St(te,ae){Oe(ae,!0);const re=()=>Le(Te,"$page",se),[se,ie]=Ae();let d=y(null),j=y(!1),D=y(!0),z=y(!1),w=y(!1);const b=ee(()=>re().params.hash);Ve(async()=>{const i=await Pe(r(b));i&&(v(d,i,!0),v(z,!0),v(D,!1));try{const{data:a,error:n}=await Ne.from("submissions").select(`
                    file_name, doc_type, compliance_status, created_at, file_size, week_number, subject, school_year,
                    profiles:user_id ( full_name, schools:school_id ( name ) ),
                    teaching_loads ( subject, grade_level )
                `).eq("file_hash",r(b)).maybeSingle();if(a){const c=a.profiles,x=a.teaching_loads,p={file_name:a.file_name,doc_type:a.doc_type,compliance_status:a.compliance_status,created_at:a.created_at,file_size:a.file_size,week_number:a.week_number,subject:a.subject,school_year:a.school_year,teacher_name:c?.full_name||null,school_name:c?.schools?.name||null,teaching_load_subject:x?.subject||null,teaching_load_grade:x?.grade_level||null};v(d,p,!0),v(z,!1),await We(r(b),p)}else r(d)||v(j,!0)}catch{r(d)||v(j,!0)}finally{v(D,!1)}});function oe(i){const a=new Date(i),n=a.toLocaleDateString("en-PH",{year:"numeric",month:"long",day:"numeric"}),c=a.toLocaleTimeString("en-PH",{hour:"2-digit",minute:"2-digit",hour12:!0});return`${n} at ${c}`}function de(i){v(w,!1);const a=i.match(/\/verify\/([a-f0-9]{64})/i),n=a?a[1]:i;n&&/^[a-f0-9]{64}$/i.test(n)&&Be(`/verify/${n}`)}function le(){v(w,!0)}var F=dt();Fe("1nolav9",i=>{Re(()=>{Ee.title="Verify Document â€” Smart E-VISION"})});var N=Ie(F);{var ne=i=>{Qe(i,{onScan:de,onClose:()=>v(w,!1)})};_(N,i=>{r(w)&&i(ne)})}var A=s(N,2),L=e(A),T=s(e(L),2);{var ce=i=>{var a=et();u(i,a)},ve=i=>{var a=tt(),n=e(a);Ue(n,{size:48,class:"text-gov-red mx-auto mb-4"});var c=s(n,6),x=e(c),p=e(x,!0);t(x),t(c),t(a),k(()=>g(p,r(b))),u(i,a)},me=i=>{var a=ot(),n=e(a),c=e(n),x=e(c);Ge(x,{size:32}),t(c);var p=s(c,4),ue=e(p);Xe(ue,{size:14,class:"text-gov-green"}),S(2),t(p);var fe=s(p,2);{var xe=o=>{var l=at(),m=e(l);Ke(m,{size:10}),S(),t(l),u(o,l)};_(fe,o=>{r(z)&&o(xe)})}t(n);var M=s(n,2),Q=e(M),C=e(Q),O=e(C),ge=e(O);Ye(ge,{size:20}),t(O);var P=s(O,2),W=s(e(P),2),_e=e(W,!0);t(W),t(P),t(C);var V=s(C,2),I=e(V),H=e(I),be=e(H);Je(be,{size:20}),t(H);var q=s(H,2),he=s(e(q),2);{let o=ee(()=>r(d).compliance_status==="on-time"||r(d).compliance_status==="compliant"?"compliant":r(d).compliance_status==="late"?"late":"non-compliant");Me(he,{get status(){return r(o)},size:"sm"})}t(q),t(I);var K=s(I,2),R=e(K),ye=e(R);Ze(ye,{size:20}),t(R);var U=s(R,2),G=s(e(U),2),ke=e(G,!0);t(G),t(U),t(K),t(V);var E=s(V,2),J=e(E);{var we=o=>{var l=rt(),m=s(e(l),2),h=e(m,!0);t(m),t(l),k(()=>g(h,r(d).teacher_name)),u(o,l)};_(J,o=>{r(d).teacher_name&&o(we)})}var X=s(J,2);{var Se=o=>{var l=st(),m=s(e(l),2),h=e(m,!0);t(m),t(l),k(()=>g(h,r(d).school_name)),u(o,l)};_(X,o=>{r(d).school_name&&o(Se)})}var je=s(X,2);{var De=o=>{var l=it(),m=s(e(l),2),h=e(m,!0);t(m),t(l),k(()=>g(h,r(d).doc_type)),u(o,l)};_(je,o=>{r(d).doc_type&&o(De)})}t(E);var Y=s(E,2),Z=s(e(Y),2),ze=e(Z,!0);t(Z),t(Y),t(Q),t(M),t(a),k(o=>{g(_e,r(d).file_name),g(ke,o),g(ze,r(b))},[()=>oe(r(d).created_at)]),u(i,a)};_(T,i=>{r(D)?i(ce):r(j)?i(ve,1):r(d)&&i(me,2)})}var B=s(T,2),$=e(B),pe=e($);qe(pe,{size:18}),S(),t($),S(2),t(B),t(L),t(A),Ce("click",$,le),u(te,F),He(),ie()}$e(["click"]);export{St as component};
